
select
CC.NAME,
CN.CAR_NAME,
date_format(CD.CREATE_DATE, '%Y') as CREATE_DATE,
COUNT(*) AS OPTION_COUNT
from
CAR_NAME CN
INNER JOIN
CAR_OPTION_DETAIL COD
ON
CN.CAR_ID = COD.CAR_ID
INNER JOIN
CAR_COMPANY CC
ON
CN.COMPANY_ID = CC.COMPANY_ID
INNER JOIN
CAR_DETAIL CD
ON
CN.CAR_ID = CD.CAR_ID
INNER JOIN
CAR_OPTION CO
ON
COD.OPTION_ID = CO.OPTION_ID
GROUP BY
CN.CAR_NAME, CC.NAME, CD.CREATE_DATE;