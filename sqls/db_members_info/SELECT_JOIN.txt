
SELECT
NAME,
HOBBY_COUNT,
AGE,
GENDER,
ADDRESS_NAME
FROM
(select
MEMBER_DEFAULT_ID,
NAME,
COUNT(*) AS HOBBY_COUNT,
AGE,
GENDER
from
MEMBER_DEFAULT
NATURAL JOIN
MEMBER_HOBBY
NATURAL JOIN
HOBBY
GROUP BY
MEMBER_DEFAULT_ID,
NAME,
AGE,
GENDER) jm
INNER JOIN
(SELECT
MEMBER_DEFAULT_ID,
MA.ADDRESS_ID,
A.ADDRESS_NAME
FROM
(SELECT
MEMBER_DEFAULT_ID,
MIN(ADDRESS_ID) AS ADDRESS_ID
FROM
MEMBER_ADDRESS
GROUP BY
MEMBER_DEFAULT_ID
HAVING
MIN(ADDRESS_ID)) MA
INNER JOIN
ADDRESS A
ON
MA.ADDRESS_ID = A.ADDRESS_ID) ja
ON
jm.MEMBER_DEFAULT_ID = ja.MEMBER_DEFAULT_ID
;
